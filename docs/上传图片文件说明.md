# ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶è¯´æ˜

## ğŸ“ éœ€è¦ä¸Šä¼ çš„ç›®å½•

**æœ¬åœ°ç›®å½•**ï¼š`D:\workspace\pan\uploads\`

**éœ€è¦ä¸Šä¼ æ•´ä¸ª `uploads` ç›®å½•åŠå…¶æ‰€æœ‰å†…å®¹åˆ°æœåŠ¡å™¨**

## ğŸ“‚ ç›®å½•ç»“æ„

```
uploads/
â”œâ”€â”€ *.jpg, *.png, *.gif ç­‰å›¾ç‰‡æ–‡ä»¶ï¼ˆæ ¹ç›®å½•ä¸‹çš„å›¾ç‰‡ï¼‰
â”œâ”€â”€ icon/                 # å›¾æ ‡ç›®å½•
â”‚   â”œâ”€â”€ certification/    # è®¤è¯åˆ†ç±»å›¾æ ‡
â”‚   â””â”€â”€ certification_service/  # è®¤è¯æœåŠ¡å›¾æ ‡
â”œâ”€â”€ images/              # å…¶ä»–å›¾ç‰‡
â”œâ”€â”€ img/                 # å›¾ç‰‡ç›®å½•
â””â”€â”€ tubiao/              # å›¾æ ‡ç›®å½•
```

## ğŸš€ ä¸Šä¼ æ­¥éª¤

### 1. ç¡®å®šæœåŠ¡å™¨ä¸Šçš„ç›®å½•ä½ç½®

æ ¹æ®ä½ çš„åç«¯éƒ¨ç½²ä½ç½®ï¼Œ`uploads` ç›®å½•åº”è¯¥æ”¾åœ¨ï¼š

**é€‰é¡¹ Aï¼šä¸åç«¯ JAR æ–‡ä»¶åŒçº§ç›®å½•**
```
/www/wwwroot/zht-lab/backend/
â”œâ”€â”€ zht-lab-backend-1.0.0.jar
â”œâ”€â”€ application.yml
â””â”€â”€ uploads/              # ä¸Šä¼ åˆ°è¿™é‡Œ
    â”œâ”€â”€ *.jpg
    â”œâ”€â”€ icon/
    â””â”€â”€ ...
```

**é€‰é¡¹ Bï¼šç‹¬ç«‹ç›®å½•ï¼ˆæ¨èï¼‰**
```
/www/wwwroot/zht-lab/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ zht-lab-backend-1.0.0.jar
â”‚   â””â”€â”€ application.yml
â””â”€â”€ uploads/              # ä¸Šä¼ åˆ°è¿™é‡Œ
    â”œâ”€â”€ *.jpg
    â”œâ”€â”€ icon/
    â””â”€â”€ ...
```

### 2. ä¸Šä¼ æ–‡ä»¶

ä½¿ç”¨ FTP/SFTP å·¥å…·æˆ–å®å¡”é¢æ¿çš„æ–‡ä»¶ç®¡ç†å™¨ï¼š

1. **ä½¿ç”¨å®å¡”é¢æ¿**ï¼š
   - ç™»å½•å®å¡”é¢æ¿
   - è¿›å…¥ `æ–‡ä»¶` ç®¡ç†
   - å¯¼èˆªåˆ°ç›®æ ‡ç›®å½•ï¼ˆå¦‚ `/www/wwwroot/zht-lab/`ï¼‰
   - ä¸Šä¼ æ•´ä¸ª `uploads` ç›®å½•

2. **ä½¿ç”¨ FTP/SFTP å·¥å…·**ï¼š
   - è¿æ¥æœåŠ¡å™¨
   - å¯¼èˆªåˆ°ç›®æ ‡ç›®å½•
   - ä¸Šä¼ æ•´ä¸ª `uploads` ç›®å½•

### 3. è®¾ç½®æ–‡ä»¶æƒé™

ä¸Šä¼ åï¼Œè®¾ç½®æ­£ç¡®çš„æƒé™ï¼š

```bash
# å¦‚æœä¸Šä¼ åˆ° /www/wwwroot/zht-lab/uploads
chown -R www:www /www/wwwroot/zht-lab/uploads
chmod -R 755 /www/wwwroot/zht-lab/uploads

# å¦‚æœä¸Šä¼ åˆ° /www/wwwroot/zht-lab/backend/uploads
chown -R www:www /www/wwwroot/zht-lab/backend/uploads
chmod -R 755 /www/wwwroot/zht-lab/backend/uploads
```

## âš™ï¸ ä¿®æ”¹åç«¯é…ç½®

ä¸Šä¼ åï¼Œéœ€è¦ä¿®æ”¹åç«¯ä»£ç ä¸­çš„è·¯å¾„é…ç½®ã€‚

### éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶

1. **`backend/src/main/java/com/zht/config/WebMvcConfig.java`**

   ä¿®æ”¹å‰ï¼š
   ```java
   registry.addResourceHandler("/uploads/**")
           .addResourceLocations("file:D:/workspace/pan/uploads/");
   ```

   ä¿®æ”¹åï¼ˆå‡è®¾ä¸Šä¼ åˆ° `/www/wwwroot/zht-lab/uploads/`ï¼‰ï¼š
   ```java
   registry.addResourceHandler("/uploads/**")
           .addResourceLocations("file:/www/wwwroot/zht-lab/uploads/");
   ```

2. **`backend/src/main/java/com/zht/controller/FileController.java`**

   ä¿®æ”¹å‰ï¼š
   ```java
   private static final String UPLOAD_DIR = "D:/workspace/pan/uploads/";
   ```

   ä¿®æ”¹åï¼š
   ```java
   private static final String UPLOAD_DIR = "/www/wwwroot/zht-lab/uploads/";
   ```

3. **`backend/src/main/java/com/zht/controller/AdminCertificateController.java`**

   æ‰¾åˆ°ç±»ä¼¼çš„è·¯å¾„é…ç½®å¹¶ä¿®æ”¹ã€‚

### é‡æ–°ç¼–è¯‘å’Œéƒ¨ç½²

ä¿®æ”¹åéœ€è¦é‡æ–°ç¼–è¯‘å’Œéƒ¨ç½²ï¼š

```bash
cd backend
mvn clean package
# ä¸Šä¼ æ–°çš„ JAR æ–‡ä»¶åˆ°æœåŠ¡å™¨
```

## ğŸ” éªŒè¯ä¸Šä¼ 

ä¸Šä¼ åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éªŒè¯ï¼š

1. **æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨**ï¼š
   ```bash
   ls -la /www/wwwroot/zht-lab/uploads/
   ```

2. **æ£€æŸ¥æ–‡ä»¶æƒé™**ï¼š
   ```bash
   stat /www/wwwroot/zht-lab/uploads/
   ```

3. **è®¿é—®å›¾ç‰‡URL**ï¼š
   - è®¿é—® `https://www.tht-lab.com.cn/api/uploads/xxx.jpg`
   - åº”è¯¥èƒ½æ­£å¸¸æ˜¾ç¤ºå›¾ç‰‡

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **è·¯å¾„ä¸€è‡´æ€§**ï¼š
   - ç¡®ä¿ `WebMvcConfig.java` å’Œ `FileController.java` ä¸­çš„è·¯å¾„ä¸€è‡´
   - ç¡®ä¿è·¯å¾„ä»¥ `/` ç»“å°¾ï¼ˆLinuxï¼‰æˆ– `\` ç»“å°¾ï¼ˆWindowsï¼‰

2. **æ–‡ä»¶æƒé™**ï¼š
   - ç¡®ä¿ Nginx ç”¨æˆ·ï¼ˆé€šå¸¸æ˜¯ `www`ï¼‰æœ‰è¯»å–æƒé™
   - ç¡®ä¿åç«¯åº”ç”¨æœ‰è¯»å†™æƒé™

3. **ç›®å½•ç»“æ„**ï¼š
   - ä¿æŒä¸æœ¬åœ°ç›¸åŒçš„ç›®å½•ç»“æ„
   - ç‰¹åˆ«æ˜¯ `icon/` å­ç›®å½•çš„ç»“æ„

4. **æ•°æ®åº“è·¯å¾„**ï¼š
   - æ•°æ®åº“ä¸­çš„å›¾ç‰‡è·¯å¾„é€šå¸¸æ˜¯ `/uploads/xxx.jpg` æˆ– `uploads/xxx.jpg`
   - è¿™äº›è·¯å¾„æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œä¸éœ€è¦ä¿®æ”¹æ•°æ®åº“

## ğŸ¯ å¿«é€Ÿæ£€æŸ¥æ¸…å•

- [ ] ä¸Šä¼ æ•´ä¸ª `uploads` ç›®å½•åˆ°æœåŠ¡å™¨
- [ ] è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
- [ ] ä¿®æ”¹ `WebMvcConfig.java` ä¸­çš„è·¯å¾„
- [ ] ä¿®æ”¹ `FileController.java` ä¸­çš„è·¯å¾„
- [ ] ä¿®æ”¹å…¶ä»–æ§åˆ¶å™¨ä¸­çš„è·¯å¾„ï¼ˆå¦‚æœæœ‰ï¼‰
- [ ] é‡æ–°ç¼–è¯‘åç«¯é¡¹ç›®
- [ ] é‡æ–°éƒ¨ç½²åç«¯ JAR æ–‡ä»¶
- [ ] é‡å¯åç«¯æœåŠ¡
- [ ] éªŒè¯å›¾ç‰‡å¯ä»¥æ­£å¸¸è®¿é—®

## ğŸ’¡ å»ºè®®

**æ¨èæ–¹æ¡ˆ**ï¼šå°† `uploads` ç›®å½•æ”¾åœ¨ä¸åç«¯ JAR æ–‡ä»¶åŒçº§æˆ–ä¸Šçº§ç›®å½•ï¼Œè¿™æ ·ä¾¿äºç®¡ç†å’Œå¤‡ä»½ã€‚

ä¾‹å¦‚ï¼š
```
/www/wwwroot/zht-lab/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ zht-lab-backend-1.0.0.jar
â”‚   â””â”€â”€ application.yml
â””â”€â”€ uploads/              # æ¨èä½ç½®
    â””â”€â”€ ...
```

è¿™æ ·é…ç½®è·¯å¾„ä¸ºï¼š`/www/wwwroot/zht-lab/uploads/`

